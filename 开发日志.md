## 前端开发日志

------

### **2022.7.11 创建项目仓库，设置工作区**

### **2022.7.12 创建前端Vue项目，并进行初始化**

**总文件名称**：`Front-end-project`

![](https://s6.jpg.cm/2022/07/12/PnygZu.png)

**完成进度：**配置对应的登录初始界面，设置基本路由，前端总体开发采用Vue+Element ui

**更新内容：**

- **vue中路由的配置与使用**

引入路由:

```vue
import VueRouter from 'vue-router'1
```

路由实例化：

```vue
Vue.use(VueRouter)1
```

定义路由中的内容：

```vue
let router = new VueRouter({
    mode: 'history',
    routes: [//这里定义路由指向的页面
        {
            path: '/',//默认时指向的页面 根目录
            component: IndexPage
        },
        {
            path: '/detail/analysis',
            component: DetailPage
        },
        {   
            //假设'/detail'与'/detail/analysis'请求的内容相同时,
            //不能直接写成以下方式，必须写成重定向方式
            //重定向的内容是该组件的真正请求路径
            /**
                   {
                        path: '/detail',
                        component: DetailPage
                    }
            */
            path: '/detail',
            component: DetailPage,
            redirect: '/detail/analysis',
            //嵌套子路由
            children: [
                {
                    path: 'analysis',
                    component: DetailAnaPage
                },
                {
                    path: 'count',
                    component: DetailCouPage
                },
            ]
        }
    ]
})
```

将路由注入Vue对象：

```vue
new Vue({
  el: '#app',
  router,
})
```

Element UI技术文档：[Element UI技术文档](https://element.eleme.cn/#/zh-CN/component/installation)

### **2022.7.13 编写首页登陆界面，确定接口传递数据方式**

**更新内容：**

- 编写`login.vue`界面，确定用户向后端传递口令和账号信息用`ajax`传递

- 主页面初步呈现效果如下：

![](https://s6.jpg.cm/2022/07/13/P5GzNW.png)

![](https://s6.jpg.cm/2022/07/13/P5Gg5S.png)

- 修改页面的路由配置，初步建立文件上传、文件删除的页面跳转规则

```vue
import Vue from 'vue'
import VueRouter from 'vue-router'
import vuexIndex from '@/store/index.js'


const Index = () => import('views/index.vue')
const Files = () => import('views/files/Files.vue')
```

- 修复登陆跳转bug
- 登录成功能够进入初始页面

![](https://s6.jpg.cm/2022/07/13/P5G3LH.png)

### 2022.7.14进行前端文件管理页面优化，添加了多个小组件显示效果，优化了对应的界面显示

- 编写音乐播放组件`MusicPlayer.vue`，显示效果如下：

<img src="https://s1.ax1x.com/2022/07/15/jhfgFx.png" title="" alt="" data-align="center">

- 编写视频播放组件以及上传进度条组件，分别为`VideoPlayer.vue`和`ProgressDialog.vue`

- 组件使用规范如下：

```javascript
import VideoPlayer from "components/videoPlayer/VideoPlayer.vue";
import MusicPlayer from "components/musicPlayer/MusicPlayer.vue";
import ProgressDialog from "components/progressDialog/ProgressDialog.vue";

export default {
  components: {
    AsideBar,
    UserInfoCard,
    VideoPlayer,
    MusicPlayer,
    ProgressDialog,
  },}
```

- 编写登录后的系统主页`index.vue`

- 系统主页预期实现效果如下：

<img title="" src="https://s1.ax1x.com/2022/07/15/jh7gDU.png" alt="" data-align="center">

- 编写相册页`Albums.vue`

<img title="" src="https://s1.ax1x.com/2022/07/15/jh7xPA.png" alt="" data-align="left">

- 编写收藏夹页面`Collectes.vue`

<img title="" src="https://s1.ax1x.com/2022/07/15/jh7bDO.png" alt="" data-align="center">

- 页面跳转功能实现：

```javascript
data() {
    return {
      asideBarData: [
        {
          path: "/files",
          name: "文件",
          icon: "wenjian",
          componentName: "files",
          params: { path: "/root" },
        },
        { path: "/albums", name: "相册", icon: "xiangce1" },
        { path: "/collectes", name: "收藏夹", icon: "favorite" },
      ],
      downloadFileInfo: {
        name: "",
        url: "",
      },
    };
  }
```

- 编写用户管理小组件`UserInfoCard.vue`，效果如下：

<img src="https://s1.ax1x.com/2022/07/15/jhIp0H.png" title="" alt="" data-align="center">

### 2022.7.16实现登录注册界面功能，实现文件上传下载

**更新内容：**

- 编写后端数据接口，实现用户登录、注册口令存储到本地数据库，数据库编写采用SQLite

```java
//登录
    @ApiOperation(value = "登录")
    @PostMapping("login")
    public R loginUser(@RequestBody UcenterMember member) {
        //member对象封装手机号和密码
        //调用service方法实现登录
        //返回token值，使用jwt生成
        String token= memberService.login(member);
        UcenterMember mem=memberService.login1(member);
        //System.out.println(mem);
        return R.ok().data("token", token).data("mem",mem);
    }

    //注册
    @PostMapping("register")
    public R registerUser(@RequestBody RegisterVo registerVo) {
        memberService.register(registerVo);
        return R.ok();
    }

    //查询用户信息
    @ApiOperation(value = "根据用户表id查询用户信息")
    @GetMapping("getMemberInfo/{id}")
    public R getMemberInfo(@PathVariable String id){
        QueryWrapper<UcenterMember> wrapper=new QueryWrapper<>();
        wrapper.eq("id",id);
        UcenterMember ucenterMember = memberService.getOne(wrapper);
        return R.ok().data("member",ucenterMember);
    }

    //修改用户信息
    @ApiOperation(value = "更新用户信息")
    @PostMapping("updateMemberInfo")
    public R updateMemberInfo(@RequestBody UcenterMember ucenterMember){
        String id = ucenterMember.getId();
        QueryWrapper<UcenterMember> w=new QueryWrapper<>();
        w.eq("id",id);
        UcenterMember one = memberService.getOne(w);
        UcenterMember member=new UcenterMember();
        member.setId(ucenterMember.getId());
        member.setNeicun(one.getNeicun());
        member.setAvatar(ucenterMember.getAvatar());
        member.setNickname(ucenterMember.getNickname());
        boolean b = memberService.updateById(member);
        if (b){
            return R.ok();
        }else{
            return R.error();
        }
    }
}
```

- 实现文件、图片格式上传存储

![](https://s6.jpg.cm/2022/07/16/P5HNkC.png)

![](https://s6.jpg.cm/2022/07/16/P5HrQR.png)

- 对用户的注册信息口令进行存储

在登录注册主页面，将用户信息存储到对应的接口所对应的数据库中

![](https://s6.jpg.cm/2022/07/16/P5HS9t.png)

**问题反馈**

对于如何加密用户的存储信息和加解密，以及实现多种方式注册信息查阅了相关资料

- 此处查阅了Vue框架对于登陆界面的规则文档，此出提供了一个思路，通过引入**crypto JS**去实现对于信息的存储

  - 示例如下：

  - **HTML code**

  - ```html
    <template>
        <el-form :model="ruleForm">
            < H3 class = "title" > system login</h3>
            <el-form-item prop="mobile"><el-input type="text" v-model=" ruleForm.mobile "Auto complete =" off "placeholder =" account "> < / El input > < / El form item >
            <el-form-item prop="password"><el-input type="text" v-model=" ruleForm.password "Auto complete =" off "placeholder =" password "> < / El input > < / El form item >
            < El checkbox V-model = "checked" checked > remember password < / El checkbox >
            <el-form-item><el-button type="primary" @ click.native.prevent= "Handlesubmit" > login < / El button > < / El form item >
        </el-form>
    </template>
    ```

  - **js code**

  - ```vue
    <script>
    Import cryptojs from 'crypto JS' // encrypt JS
    export default {
        data() {
            return {
                ruleForm: {
                    Mobile: ', // account number
                    Password: '// password
                },
                Checked: true // check remember password. True is selected
            };
        },
        //Judge whether to remember the password
        //Note that true here is a string format, because Boolean will become string when stored in localstorage
        created(){
            //Judge whether to remember the password
            if(localStorage.getItem("rememberPsw") == 'true'){
                this.getCookie()
            }
        },
        methods:{
            //Login method
            handleSubmit() {
                var that = this;
                let loginParams = {
                   mobile:  this.ruleForm.mobile , // get the account number
                   password:  this.ruleForm.password  //Get password
                };
                if (that.checked == true) {
                    //Incoming account, password, save days
                    that.setCookie(that.ruleForm.mobile, that.ruleForm.password, 1);
                } else {
                    //Empty cookie
                    that.clearCookie();
                }
                    localStorage.setItem("rememberPsw", that.checked);
                //// login request
                // that.$axios.post(`${api}/auth/login`,loginParams).then((res)=>{
                //     if(res.data.errCode == 0){
                //          console.log ('login succeeded ')
                //         if (that.checked == true) {
                //             //Incoming account, password, save days
                //             that.setCookie(that.ruleForm.mobile, that.ruleForm.password, 7);
                //         } else {
                //             //Empty cookie
                //             that.clearCookie();
                //         }
                //// jump route
                //         that.$router.push({ path: '/index' });
                //     }else{
                //          console.log ('login failed ')
                //     }
                // })
            },
            //Set cookie method
            setCookie(mobile, password, days) {
                var text =  CryptoJS.AES.encrypt (password, 'secret key 123'); // encrypt with cryptojs method
                Var savedays = new date(); // get time
                saveDays.setTime ( saveDays.getTime () + 24 * 60 * 60 * 1000 * days); // number of days to save
                console.log(saveDays)
                console.log(saveDays.toGMTString())
                //String splicing into cookie
                // window.document.cookie = "mobile" + "=" + mobile + ";path=/;saveDays=" + saveDays.toGMTString();
                // window.document.cookie = "password" + "=" + text + ";path=/;saveDays=" + saveDays.toGMTString();
                
                window.document.cookie = "mobile" + "=" + mobile + ";path=/;expires=" + saveDays.toGMTString();
                window.document.cookie = "password" + "=" + text + ";path=/;expires=" + saveDays.toGMTString();
            },
            //Read cookie
            getCookie() {
                if (document.cookie.length > 0) {
                    var arr =  document.cookie.split (';'; // the format shown here needs to be cut. You can output it by yourself
                    console.log(arr)
                    for (var i = 0; i < arr.length; i++) {
                        Var arr2 = arr [i]. Split ('='); // cut again
                        //Here, the array with mobile as item 0 and the array with password as item 0 will be cut to determine and find the corresponding value
                        if (arr2[0] == 'mobile') {
                            this.ruleForm.mobile  =Arr2 [1]; // get the account number
                        } else if (arr2[0] == 'password') {
                            //Get the encrypted password arr2 [1] and decrypt it
                            var bytes = CryptoJS.AES.decrypt(arr2[1].toString(), 'secret key 123');
                            var plaintext =  bytes.toString ( CryptoJS.enc.Utf8 ）; // get the decrypted password (the password entered during login)
                            this.ruleForm.password = plaintext;
                        }
                    }
                }
            },
            //Clear cookies
            clearCookie() {
                this.setCookie (',', 0); // set the account password to blank and the number of days to 0
            }
        }
    }
    </script>
    ```

    

